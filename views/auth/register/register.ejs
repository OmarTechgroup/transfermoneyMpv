<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscription - MoneyTransfer Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

</head>
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
        background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        padding: 20px;
    }

    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px 0;
        color: white;
    }

    .back-btn {
        color: white;
        text-decoration: none;
        font-size: 16px;
        display: flex;
        align-items: center;
    }

    .back-btn i {
        margin-right: 8px;
    }

    .logo {
        display: flex;
        align-items: center;
        font-size: 20px;
        font-weight: 700;
    }

    .logo i {
        margin-right: 10px;
        font-size: 24px;
    }

    .language-selector {
        background: rgba(255, 255, 255, 0.2);
        border: none;
        color: white;
        padding: 8px 12px;
        border-radius: 20px;
        font-size: 14px;
    }

    .container {
        background: white;
        border-radius: 20px;
        padding: 30px 25px;
        margin-top: 10px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        flex: 1;
    }

    .welcome-text {
        text-align: center;
        margin-bottom: 25px;
    }

    .welcome-text h1 {
        color: #1a2a6c;
        font-size: 24px;
        margin-bottom: 10px;
    }

    .welcome-text p {
        color: #666;
        font-size: 15px;
    }

    .progress-steps {
        display: flex;
        justify-content: space-between;
        margin-bottom: 25px;
        position: relative;
    }

    .progress-steps::before {
        content: '';
        position: absolute;
        top: 15px;
        left: 0;
        right: 0;
        height: 3px;
        background: #eee;
        z-index: 1;
    }

    .progress-bar {
        position: absolute;
        top: 15px;
        left: 0;
        height: 3px;
        background: #4a54e1;
        z-index: 2;
        transition: width 0.3s ease;
    }

    .step {
        display: flex;
        flex-direction: column;
        align-items: center;
        z-index: 3;
    }

    .step-icon {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        background: #eee;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        color: #777;
        margin-bottom: 8px;
        transition: all 0.3s ease;
    }

    .step.active .step-icon {
        background: #4a54e1;
        color: white;
    }

    .step.completed .step-icon {
        background: #4CAF50;
        color: white;
    }

    .step-text {
        font-size: 12px;
        color: #777;
        text-align: center;
    }

    .step.active .step-text {
        color: #4a54e1;
        font-weight: 500;
    }

    .form-section {
        display: none;
    }

    .form-section.active {
        display: block;
        animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .form-group {
        margin-bottom: 20px;
    }

    .form-group label {
        display: block;
        margin-bottom: 8px;
        color: #555;
        font-weight: 500;
        font-size: 14px;
    }

    .input-with-icon {
        position: relative;
    }

    .input-with-icon i {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: #777;
    }

    .form-control {
        width: 100%;
        padding: 16px 15px 16px 45px;
        border: 1px solid #ddd;
        border-radius: 10px;
        font-size: 16px;
        transition: all 0.3s;
    }

    .form-control:focus {
        border-color: #4a54e1;
        box-shadow: 0 0 0 2px rgba(74, 84, 225, 0.2);
        outline: none;
    }

    .password-toggle {
        position: absolute;
        right: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: #777;
        background: none;
        border: none;
        cursor: pointer;
    }

    .name-fields {
        display: flex;
        gap: 15px;
    }

    .name-fields .form-group {
        flex: 1;
    }

    .phone-group {
        display: flex;
    }

    .country-code {
        width: 80px;
        padding: 16px 10px;
        border: 1px solid #ddd;
        border-right: none;
        border-radius: 10px 0 0 10px;
        background: #f9f9f9;
        text-align: center;
    }

    .phone-input {
        border-radius: 0 10px 10px 0;
    }

    .terms {
        display: flex;
        align-items: flex-start;
        margin-bottom: 20px;
        font-size: 14px;
    }

    .terms input {
        margin-right: 10px;
        margin-top: 3px;
    }

    .terms a {
        color: #4a54e1;
        text-decoration: none;
    }

    .btn-action {
        background: linear-gradient(to right, #1a2a6c, #4a54e1);
        color: white;
        border: none;
        padding: 18px;
        border-radius: 10px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        width: 100%;
        margin-bottom: 15px;
        box-shadow: 0 4px 10px rgba(74, 84, 225, 0.3);
    }

    .btn-action:active {
        transform: translateY(2px);
        box-shadow: 0 2px 5px rgba(74, 84, 225, 0.3);
    }

    .btn-secondary {
        background: #f0f0f0;
        color: #555;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    .btn-secondary:active {
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .action-buttons {
        display: flex;
        gap: 15px;
    }

    .action-buttons .btn-action {
        flex: 1;
    }

    .login-link {
        text-align: center;
        color: #555;
        font-size: 15px;
        margin-top: 20px;
    }

    .login-link a {
        color: #4a54e1;
        text-decoration: none;
        font-weight: 500;
    }

    .security-note {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-top: 25px;
        font-size: 12px;
        color: #777;
    }

    .security-note i {
        margin-right: 5px;
        color: #4CAF50;
    }

    .features {
        display: flex;
        justify-content: space-between;
        margin-top: 30px;
        padding: 0 10px;
    }

    .feature {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        color: white;
        width: 30%;
    }

    .feature i {
        font-size: 20px;
        margin-bottom: 8px;
        background: rgba(255, 255, 255, 0.2);
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .feature span {
        font-size: 12px;
        font-weight: 500;
    }

    .loading {
        display: none;
    }

    .loading.active {
        display: inline-block;
        animation: spin 1s linear infinite;
    }

    @keyframes spin {
        0% {
            transform: rotate(0deg);
        }

        100% {
            transform: rotate(360deg);
        }
    }

    .success-message {
        text-align: center;
        padding: 30px 0;
        display: none;
    }

    .success-message.active {
        display: block;
        animation: fadeIn 0.5s ease;
    }

    .success-icon {
        font-size: 60px;
        color: #4CAF50;
        margin-bottom: 20px;
    }

    @media (min-width: 768px) {
        body {
            justify-content: center;
            align-items: center;
        }

        .container {
            width: 450px;
        }
    }
</style>

<body>
    <div class="header">
        <a href="#" class="back-btn" id="backBtn">
            <i class="fas fa-arrow-left"></i>
        </a>
        <div class="logo">
            <i class="fas fa-money-bill-transfer"></i>
            <span>MoneyTransfer</span>
        </div>

    </div>

    <div class="container">
        <div class="welcome-text">
            <h1>Créer un compte</h1>
            <p>Rejoignez notre communauté sécurisée</p>
        </div>

        <div class="progress-steps">
            <div class="progress-bar" id="progressBar" style="width: 33%"></div>
            <div class="step active" data-step="1">
                <div class="step-icon">1</div>
                <div class="step-text">Infos<br>personnelles</div>
            </div>
            <div class="step" data-step="2">
                <div class="step-icon">2</div>
                <div class="step-text">Sécurité<br>compte</div>
            </div>
            <div class="step" data-step="3">
                <div class="step-icon">3</div>
                <div class="step-text">Confirmation</div>
            </div>
        </div>

        <form id="registerForm">
            <!-- Étape 1: Informations personnelles -->
            <div class="form-section active" id="step1">
                <div class="name-fields">
                    <div class="form-group">
                        <label for="firstName">Prénom</label>
                        <div class="input-with-icon">
                            <i class="fas fa-user"></i>
                            <input type="text" id="firstName" class="form-control" placeholder="Votre prénom" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="lastName">Nom</label>
                        <div class="input-with-icon">
                            <i class="fas fa-user"></i>
                            <input type="text" id="lastName" class="form-control" placeholder="Votre nom" required>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="email">Adresse e-mail</label>
                    <div class="input-with-icon">
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="email" class="form-control" placeholder="votre@email.com" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="phone">Numéro de téléphone</label>
                    <div class="phone-group">
                        <select class="country-code">
                            <option>+221</option>
                            <option>+33</option>
                            <option>+41</option>
                            <option>+1</option>
                        </select>
                        <div class="input-with-icon" style="flex: 1;">
                            <input type="tel" id="phone" class="form-control phone-input" placeholder="Votre numéro"
                                required>
                        </div>
                    </div>
                </div>
                <!--  
                <div class="form-group">
                    <label for="country">Pays de résidence</label>
                    <div class="input-with-icon">
                        <i class="fas fa-globe"></i>
                        <select id="country" class="form-control" required>
                            <option value="">Sélectionnez votre pays</option>
                            <option>Sénégal</option>
                            <option>France</option>
                            <option>Belgique</option>
                            <option>Suisse</option>
                            <option>Canada</option>
                            <option>Autre</option>
                        </select>
                    </div>
                </div>
                -->

                <button type="button" class="btn-action" id="nextToStep2">Continuer</button>
            </div>

            <!-- Étape 2: Sécurité du compte -->
            <div class="form-section" id="step2">
                <div class="form-group">
                    <label for="password">Mot de passe</label>
                    <div class="input-with-icon">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="password" class="form-control" placeholder="Créez un mot de passe"
                            required>
                        <button type="button" class="password-toggle" id="togglePassword1">
                            <i class="far fa-eye"></i>
                        </button>
                    </div>
                    <div class="password-strength">
                        <div style="font-size: 12px; margin-top: 5px; color: #777;">
                            <span id="passwordStrength">Faible</span>
                            <div style="height: 4px; background: #eee; border-radius: 2px; margin-top: 5px;">
                                <div id="passwordStrengthBar"
                                    style="height: 100%; width: 20%; background: #ff4757; border-radius: 2px;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="confirmPassword">Confirmer le mot de passe</label>
                    <div class="input-with-icon">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="confirmPassword" class="form-control"
                            placeholder="Confirmez votre mot de passe" required>
                        <button type="button" class="password-toggle" id="togglePassword2">
                            <i class="far fa-eye"></i>
                        </button>
                    </div>
                    <div id="passwordMatch" style="font-size: 12px; margin-top: 5px; display: none;">
                        <i class="fas fa-check" style="color: #4CAF50;"></i> Les mots de passe correspondent
                    </div>
                </div>

                <div class="terms">
                    <input type="checkbox" id="terms" required>
                    <label for="terms">J'accepte les <a href="#">conditions d'utilisation</a> et la <a
                            href="#">politique de confidentialité</a></label>
                </div>

                <div class="terms">
                    <input type="checkbox" id="newsletter">
                    <label for="newsletter">Je souhaite recevoir des offres promotionnelles et des mises à jour</label>
                </div>

                <div class="action-buttons">
                    <button type="button" class="btn-action btn-secondary" id="backToStep1">Retour</button>
                    <button type="button" class="btn-action" id="nextToStep3">Continuer</button>
                </div>
            </div>

            <!-- Étape 3: Confirmation -->
            <div class="form-section" id="step3">
                <div class="success-message" id="successMessage">
                    <div class="success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h2 style="color: #1a2a6c; margin-bottom: 15px;">Compte créé avec succès!</h2>
                    <p style="color: #666; margin-bottom: 25px;">Nous avons envoyé un e-mail de confirmation à <span
                            id="userEmail" style="font-weight: 500;"></span></p>
                    <button type="button" class="btn-action" id="goToLogin">Se connecter</button>
                </div>

                <div id="confirmationForm">
                    <div class="form-group">
                        <label for="verificationCode">Code de vérification</label>
                        <div class="input-with-icon">
                            <i class="fas fa-shield-alt"></i>
                            <input type="text" id="verificationCode" class="form-control"
                                placeholder="Entrez le code reçu par e-mail" required>
                        </div>
                        <div style="font-size: 14px; margin-top: 5px; color: #777;">
                            <a href="#" id="resendCode">Renvoyer le code</a>
                            <span id="countdown" style="margin-left: 10px;">(1:00)</span>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button type="button" class="btn-action btn-secondary" id="backToStep2">Retour</button>
                        <button type="submit" class="btn-action" id="completeRegistration">
                            <span class="btn-text">Finaliser l'inscription</span>
                            <i class="fas fa-spinner loading"></i>
                        </button>
                    </div>
                </div>
            </div>
        </form>

        <div class="login-link">
            Vous avez déjà un compte ? <a href="login">Se connecter</a>
        </div>

        <div class="security-note">
            <i class="fas fa-shield-alt"></i>
            Vos informations sont sécurisées et cryptées
        </div>
    </div>

    <div class="features">
        <div class="feature">
            <i class="fas fa-shield-alt"></i>
            <span>Sécurisé</span>
        </div>
        <div class="feature">
            <i class="fas fa-bolt"></i>
            <span>Rapide</span>
        </div>
        <div class="feature">
            <i class="fas fa-globe"></i>
            <span>Global</span>
        </div>
    </div>
    <script src="../../indexedDB.js"></script>
    <script>
        const dbVersion = 1;
        let dbe

        const requests = indexedDB.open('MoneyTransferPro', dbVersion);

        requests.onerror = (e) => {
            console.error("Erreur IndexedDB:", e.target.error);
            alert("Erreur critique: La base de données ne peut pas être ouverte.");
        };
        requests.onsuccess = (e) => {
            dbe = e.target.result;
            console.log("ouverture de la db :", db);

        }


        function addUser() {
            const user = {
                prenom: document.getElementById('firstName').value.trim(),
                nom: document.getElementById('lastName').value.trim(),
                email: document.getElementById('email').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                password: document.getElementById('password').value,
                balance: 1000
            };

            if (!user.email || !user.password) {
                alert("Email et mot de passe sont obligatoires !");
                return;
            }

            const transaction = dbe.transaction('users', 'readwrite');
            const store = transaction.objectStore('users');

            const requestss = store.add(user);

            requestss.onsuccess = () => {
                console.log("✅ Utilisateur ajouté avec succès !");
                alert("Utilisateur ajouté avec succès !");
            };

            requestss.onerror = (e) => {
                console.error("❌ Erreur:", e.target.error);
                alert("Erreur: cet utilisateur existe déjà ou un problème est survenu.");
            };
        }

        document.addEventListener('DOMContentLoaded', function () {
            // Variables globales
            let currentStep = 1;
            const totalSteps = 3;
            const progressBar = document.getElementById('progressBar');
            const passwordInput = document.getElementById('password');
            const confirmPasswordInput = document.getElementById('confirmPassword');
            const passwordStrengthBar = document.getElementById('passwordStrengthBar');
            const passwordStrengthText = document.getElementById('passwordStrength');
            const passwordMatch = document.getElementById('passwordMatch');
            const userEmail = document.getElementById('userEmail');
            const countdown = document.getElementById('countdown');
            let countdownTimer;
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;

            // Navigation entre les étapes
            document.getElementById('nextToStep2').addEventListener('click', function () {
                if (validateStep1()) {
                    navigateToStep(2);
                }
            });

            document.getElementById('backToStep1').addEventListener('click', function () {
                navigateToStep(1);
            });

            document.getElementById('nextToStep3').addEventListener('click', function () {
                if (validateStep2()) {
                    // Afficher l'e-mail de l'utilisateur dans le message de confirmation
                    userEmail.textContent = document.getElementById('email').value;
                    navigateToStep(3);
                    startCountdown();
                }
            });

            document.getElementById('backToStep2').addEventListener('click', function () {
                navigateToStep(2);
                clearInterval(countdownTimer);
            });

            document.getElementById('goToLogin').addEventListener('click', function () {
                alert('Redirection vers la page de connexion...');
                // Ici, vous redirigeriez vers la page de connexion
                window.location.href = "home";
            });



            document.getElementById('backBtn').addEventListener('click', function (e) {
                e.preventDefault();
                if (currentStep > 1) {
                    navigateToStep(currentStep - 1);
                    if (currentStep === 3) {
                        clearInterval(countdownTimer);
                    }
                } else {
                    // Retour à la page précédente (connexion)
                    alert('Retour à la page de connexion...');
                }
            });

            // Fonction de navigation entre les étapes
            function navigateToStep(step) {
                // Masquer l'étape actuelle
                document.querySelector(`#step${currentStep}`).classList.remove('active');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');

                // Afficher la nouvelle étape
                document.querySelector(`#step${step}`).classList.add('active');
                document.querySelector(`.step[data-step="${step}"]`).classList.add('active');

                // Mettre à jour la barre de progression
                const progressWidth = ((step - 1) / (totalSteps - 1)) * 100;
                progressBar.style.width = `${progressWidth}%`;

                // Marquer les étapes précédentes comme complétées
                for (let i = 1; i < step; i++) {
                    document.querySelector(`.step[data-step="${i}"]`).classList.add('completed');
                }

                currentStep = step;
            }

            // Validation de l'étape 1
            function validateStep1() {
                const firstName = document.getElementById('firstName').value;
                const lastName = document.getElementById('lastName').value;
                const email = document.getElementById('email').value;
                const phone = document.getElementById('phone').value;

                if (!firstName || !lastName || !email || !phone) {
                    alert('Veuillez remplir tous les champs obligatoires');
                    return false;
                }

                // Validation basique de l'email
                const emailRegex = /^[^S@]+@[^S@]+\.[^S@]+$/;
                if (!emailRegex.test(email)) {
                    alert('Veuillez entrer une adresse e-mail valide');
                    return false;
                }

                return true;
            }

            // Validation de l'étape 2
            function validateStep2() {
                const password = passwordInput.value;
                const confirmPassword = confirmPasswordInput.value;
                const terms = document.getElementById('terms').checked;

                if (!password || !confirmPassword) {
                    alert('Veuillez remplir tous les champs de mot de passe');
                    return false;
                }

                if (password !== confirmPassword) {
                    alert('Les mots de passe ne correspondent pas');
                    return false;
                }

                if (password.length < 8) {
                    alert('Le mot de passe doit contenir au moins 8 caractères');
                    return false;
                }

                if (!terms) {
                    alert('Veuillez accepter les conditions d\'utilisation');
                    return false;
                }

                return true;
            }

            // Gestion de l'affichage/masquage des mots de passe
            document.getElementById('togglePassword1').addEventListener('click', function () {
                togglePasswordVisibility(passwordInput, this);
            });

            document.getElementById('togglePassword2').addEventListener('click', function () {
                togglePasswordVisibility(confirmPasswordInput, this);
            });

            function togglePasswordVisibility(input, button) {
                const type = input.getAttribute('type') === 'password' ? 'text' : 'password';
                input.setAttribute('type', type);
                button.innerHTML = type === 'password' ? '<i class="far fa-eye"></i>' : '<i class="far fa-eye-slash"></i>';
            }

            // Vérification de la force du mot de passe
            passwordInput.addEventListener('input', function () {
                checkPasswordStrength(this.value);
                checkPasswordMatch();
            });

            confirmPasswordInput.addEventListener('input', checkPasswordMatch);

            function checkPasswordStrength(password) {
                let strength = 0;
                let color = '#ff4757';
                let text = 'Faible';

                if (password.length >= 8) strength += 1;
                if (password.match(/[a-z]/) && password.match(/[A-Z]/)) strength += 1;
                if (password.match(/\d/)) strength += 1;
                if (password.match(/[^a-zA-Z\d]/)) strength += 1;

                if (strength === 1) {
                    color = '#ff4757';
                    text = 'Faible';
                    passwordStrengthBar.style.width = '25%';
                } else if (strength === 2) {
                    color = '#ffa502';
                    text = 'Moyen';
                    passwordStrengthBar.style.width = '50%';
                } else if (strength === 3) {
                    color = '#2ed573';
                    text = 'Bon';
                    passwordStrengthBar.style.width = '75%';
                } else if (strength === 4) {
                    color = '#2ed573';
                    text = 'Fort';
                    passwordStrengthBar.style.width = '100%';
                } else {
                    passwordStrengthBar.style.width = '5%';
                }

                passwordStrengthBar.style.background = color;
                passwordStrengthText.textContent = text;
                passwordStrengthText.style.color = color;
            }

            function checkPasswordMatch() {
                const password = passwordInput.value;
                const confirmPassword = confirmPasswordInput.value;

                if (password && confirmPassword) {
                    if (password === confirmPassword) {
                        passwordMatch.style.display = 'block';
                        confirmPasswordInput.style.borderColor = '#4CAF50';
                    } else {
                        passwordMatch.style.display = 'none';
                        confirmPasswordInput.style.borderColor = '#ff4757';
                    }
                } else {
                    passwordMatch.style.display = 'none';
                }
            }

            // Gestion du compte à rebours
            function startCountdown() {
                let timeLeft = 60;
                countdown.textContent = `(1:00)`;

                clearInterval(countdownTimer);
                countdownTimer = setInterval(() => {
                    timeLeft--;
                    const minutes = Math.floor(timeLeft / 60);
                    const seconds = timeLeft % 60;
                    countdown.textContent = `(${minutes}:${seconds.toString().padStart(2, '0')})`;

                    if (timeLeft <= 0) {
                        clearInterval(countdownTimer);
                    }
                }, 1000);
            }

            document.getElementById('resendCode').addEventListener('click', function (e) {
                e.preventDefault();
                startCountdown();
                alert('Code de vérification renvoyé!');
            });

            // Soumission du formulaire final
            document.getElementById('registerForm').addEventListener('submit', function (e) {
            e.preventDefault();

            const verificationCode = document.getElementById('verificationCode').value;

            if (!verificationCode) {
                alert('Veuillez entrer le code de vérification');
                return;
            }
            addUser();



            // Simulation d'inscription
            const btnText = document.querySelector('#completeRegistration .btn-text');
            const loadingIcon = document.querySelector('#completeRegistration .loading');
            alert('Inscription réussie!');
            btnText.textContent = 'Traitement...';
            loadingIcon.classList.add('active');
            document.getElementById('completeRegistration').disabled = true;


            setTimeout(() => {
                // Afficher le message de succès
                document.getElementById('confirmationForm').style.display = 'none';
                document.getElementById('successMessage').classList.add('active');

                clearInterval(countdownTimer);
            }, 2000);
        });

        // Animation d'entrée
        const container = document.querySelector('.container');
        container.style.opacity = '0';
        container.style.transform = 'translateY(20px)';

        setTimeout(() => {
            container.style.transition = 'opacity 0.5s, transform 0.5s';
            container.style.opacity = '1';
            container.style.transform = 'translateY(0)';
        }, 300);
        });
    </script>
</body>

</html>